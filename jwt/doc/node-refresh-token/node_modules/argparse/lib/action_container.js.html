<!DOCTYPE html>
<html>
<head>
  <title>action_container.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../doc-style.css" />
  <script src="../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../";
    var thisFile = "node-refresh-token\\node_modules\\argparse\\lib\\action_container.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h5">
        <a href="#options">Options:</a>
      </div>

      <div class="heading h4">
        <a href="#examples">Examples</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>action_container.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<div class="dox">
<div class="summary">
<p>internal
class ActionContainer</p>
</div>
<div class="body">
<p>Action container. Parent for [[ArgumentParser]] and [[ArgumentGroup]]</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">
'use strict'</span>;

<span class="hljs-keyword">var</span> format = <span class="hljs-built_in">require</span>(<span class="hljs-string">'util'</span>).format;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>Constants</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> c = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./const'</span>);

<span class="hljs-keyword">var</span> $$ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./utils'</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Actions</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> ActionHelp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./action/help'</span>);
<span class="hljs-keyword">var</span> ActionAppend = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./action/append'</span>);
<span class="hljs-keyword">var</span> ActionAppendConstant = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./action/append/constant'</span>);
<span class="hljs-keyword">var</span> ActionCount = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./action/count'</span>);
<span class="hljs-keyword">var</span> ActionStore = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./action/store'</span>);
<span class="hljs-keyword">var</span> ActionStoreConstant = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./action/store/constant'</span>);
<span class="hljs-keyword">var</span> ActionStoreTrue = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./action/store/true'</span>);
<span class="hljs-keyword">var</span> ActionStoreFalse = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./action/store/false'</span>);
<span class="hljs-keyword">var</span> ActionVersion = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./action/version'</span>);
<span class="hljs-keyword">var</span> ActionSubparsers = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./action/subparsers'</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Errors</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> argumentErrorHelper = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./argument/error'</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<p>new ActionContainer(options)</p>
</div>
<div class="body">
<p>Action container. Parent for [[ArgumentParser]] and [[ArgumentGroup]]</p>
<div class="pilwrap" id="options">
  <h5>
    <a href="#options" name="options" class="pilcrow"></a>
Options:
  </h5>
</div>
<ul>
<li><code>description</code> -- A description of what the program does</li>
<li><code>prefixChars</code>  -- Characters that prefix optional arguments</li>
<li><code>argumentDefault</code>  -- The default value for all arguments</li>
<li><code>conflictHandler</code> -- The conflict handler to use for duplicate arguments</li>
</ul>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> ActionContainer = <span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ActionContainer</span>(<span class="hljs-params">options</span>) </span>{
  options = options || {};

  <span class="hljs-keyword">this</span>.description = options.description;
  <span class="hljs-keyword">this</span>.argumentDefault = options.argumentDefault;
  <span class="hljs-keyword">this</span>.prefixChars = options.prefixChars || <span class="hljs-string">''</span>;
  <span class="hljs-keyword">this</span>.conflictHandler = options.conflictHandler;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>set up registries</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>._registries = {};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>register actions</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>.register(<span class="hljs-string">'action'</span>, <span class="hljs-literal">null</span>, ActionStore);
  <span class="hljs-keyword">this</span>.register(<span class="hljs-string">'action'</span>, <span class="hljs-string">'store'</span>, ActionStore);
  <span class="hljs-keyword">this</span>.register(<span class="hljs-string">'action'</span>, <span class="hljs-string">'storeConst'</span>, ActionStoreConstant);
  <span class="hljs-keyword">this</span>.register(<span class="hljs-string">'action'</span>, <span class="hljs-string">'storeTrue'</span>, ActionStoreTrue);
  <span class="hljs-keyword">this</span>.register(<span class="hljs-string">'action'</span>, <span class="hljs-string">'storeFalse'</span>, ActionStoreFalse);
  <span class="hljs-keyword">this</span>.register(<span class="hljs-string">'action'</span>, <span class="hljs-string">'append'</span>, ActionAppend);
  <span class="hljs-keyword">this</span>.register(<span class="hljs-string">'action'</span>, <span class="hljs-string">'appendConst'</span>, ActionAppendConstant);
  <span class="hljs-keyword">this</span>.register(<span class="hljs-string">'action'</span>, <span class="hljs-string">'count'</span>, ActionCount);
  <span class="hljs-keyword">this</span>.register(<span class="hljs-string">'action'</span>, <span class="hljs-string">'help'</span>, ActionHelp);
  <span class="hljs-keyword">this</span>.register(<span class="hljs-string">'action'</span>, <span class="hljs-string">'version'</span>, ActionVersion);
  <span class="hljs-keyword">this</span>.register(<span class="hljs-string">'action'</span>, <span class="hljs-string">'parsers'</span>, ActionSubparsers);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>raise an exception if the conflict handler is invalid</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>._getHandler();

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>action storage</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>._actions = [];
  <span class="hljs-keyword">this</span>._optionStringActions = {};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>groups</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>._actionGroups = [];
  <span class="hljs-keyword">this</span>._mutuallyExclusiveGroups = [];

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>defaults storage</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>._defaults = {};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>determines whether an &quot;option&quot; looks like a negative number
-1, -1.5 -5e+4</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>._regexpNegativeNumber = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'^[-]?[0-9]*\\.?[0-9]+([eE][-+]?[0-9]+)?$'</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>whether or not there are any optionals that look like negative
numbers -- uses a list so it can be shared and edited</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>._hasNegativeNumberOptionals = [];
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>Groups must be required, then ActionContainer already defined</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> ArgumentGroup = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./argument/group'</span>);
<span class="hljs-keyword">var</span> MutuallyExclusiveGroup = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./argument/exclusive'</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>Registration methods</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<div class="dox">
<div class="summary">
<p>ActionContainer#register(registryName, value, object) -&gt; Void</p>
<ul>
<li>registryName (String) : object type action|type</li>
<li>value (string) : keyword</li>
<li>object (Object|Function) : handler</li>
</ul>
</div>
<div class="body">
<p>Register handlers</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">ActionContainer.prototype.register = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">registryName, value, object</span>) </span>{
  <span class="hljs-keyword">this</span>._registries[registryName] = <span class="hljs-keyword">this</span>._registries[registryName] || {};
  <span class="hljs-keyword">this</span>._registries[registryName][value] = object;
};

ActionContainer.prototype._registryGet = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">registryName, value, defaultValue</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length &lt; <span class="hljs-number">3</span>) {
    defaultValue = <span class="hljs-literal">null</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._registries[registryName][value] || defaultValue;
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>Namespace default accessor methods</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<div class="dox">
<div class="summary">
<p>ActionContainer#setDefaults(options) -&gt; Void</p>
<ul>
<li>options (object):hash of options see [[Action.new]]</li>
</ul>
</div>
<div class="body">
<p>Set defaults</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">ActionContainer.prototype.setDefaults = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">options</span>) </span>{
  options = options || {};
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> property <span class="hljs-keyword">in</span> options) {
    <span class="hljs-keyword">if</span> ($$.has(options, property)) {
      <span class="hljs-keyword">this</span>._defaults[property] = options[property];
    }
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>if these defaults match any existing arguments, replace the previous
default on the object with the new one</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>._actions.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">action</span>) </span>{
    <span class="hljs-keyword">if</span> ($$.has(options, action.dest)) {
      action.defaultValue = options[action.dest];
    }
  });
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<div class="dox">
<div class="summary">
<p>ActionContainer#getDefault(dest) -&gt; Mixed</p>
<ul>
<li>dest (string): action destination</li>
</ul>
</div>
<div class="body">
<p>Return action default value</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">ActionContainer.prototype.getDefault = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">dest</span>) </span>{
  <span class="hljs-keyword">var</span> result = $$.has(<span class="hljs-keyword">this</span>._defaults, dest) ? <span class="hljs-keyword">this</span>._defaults[dest] : <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">this</span>._actions.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">action</span>) </span>{
    <span class="hljs-keyword">if</span> (action.dest === dest &amp;&amp; $$.has(action, <span class="hljs-string">'defaultValue'</span>)) {
      result = action.defaultValue;
    }
  });

  <span class="hljs-keyword">return</span> result;
};
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<p>Adding argument actions</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<p>ActionContainer#addArgument(args, options) -&gt; Object</p>
<ul>
<li>args (String|Array): argument key, or array of argument keys</li>
<li>options (Object): action objects see [[Action.new]]</li>
</ul>
</div>
<div class="body">
<div class="pilwrap" id="examples">
  <h4>
    <a href="#examples" name="examples" class="pilcrow"></a>
Examples
  </h4>
</div>
<ul>
<li>addArgument([ '-f', '--foo' ], { action: 'store', defaultValue: 1, ... })</li>
<li>addArgument([ 'bar' ], { action: 'store', nargs: 1, ... })</li>
<li>addArgument('--baz', { action: 'store', nargs: 1, ... })</li>
</ul>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">ActionContainer.prototype.addArgument = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">args, options</span>) </span>{
  args = args;
  options = options || {};

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> args === <span class="hljs-string">'string'</span>) {
    args = [ args ];
  }
  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Array</span>.isArray(args)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'addArgument first argument should be a string or an array'</span>);
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> options !== <span class="hljs-string">'object'</span> || <span class="hljs-built_in">Array</span>.isArray(options)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'addArgument second argument should be a hash'</span>);
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<p>if no positional args are supplied or only one is supplied and
it doesn't look like an option string, parse a positional argument</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (!args || args.length === <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-keyword">this</span>.prefixChars.indexOf(args[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]) &lt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">if</span> (args &amp;&amp; !!options.dest) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'dest supplied twice for positional argument'</span>);
    }
    options = <span class="hljs-keyword">this</span>._getPositional(args, options);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24"></a>
</div>
<p>otherwise, we're adding an optional argument</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  } <span class="hljs-keyword">else</span> {
    options = <span class="hljs-keyword">this</span>._getOptional(args, options);
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25"></a>
</div>
<p>if no default was supplied, use the parser-level default</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> options.defaultValue === <span class="hljs-string">'undefined'</span>) {
    <span class="hljs-keyword">var</span> dest = options.dest;
    <span class="hljs-keyword">if</span> ($$.has(<span class="hljs-keyword">this</span>._defaults, dest)) {
      options.defaultValue = <span class="hljs-keyword">this</span>._defaults[dest];
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.argumentDefault !== <span class="hljs-string">'undefined'</span>) {
      options.defaultValue = <span class="hljs-keyword">this</span>.argumentDefault;
    }
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26"></a>
</div>
<p>create the action object, and add it to the parser</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> ActionClass = <span class="hljs-keyword">this</span>._popActionClass(options);
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> ActionClass !== <span class="hljs-string">'function'</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(format(<span class="hljs-string">'Unknown action "%s".'</span>, ActionClass));
  }
  <span class="hljs-keyword">var</span> action = <span class="hljs-keyword">new</span> ActionClass(options);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27"></a>
</div>
<p>throw an error if the action type is not callable</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> typeFunction = <span class="hljs-keyword">this</span>._registryGet(<span class="hljs-string">'type'</span>, action.type, action.type);
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> typeFunction !== <span class="hljs-string">'function'</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(format(<span class="hljs-string">'"%s" is not callable'</span>, typeFunction));
  }

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._addAction(action);
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28"></a>
</div>
<div class="dox">
<div class="summary">
<p>ActionContainer#addArgumentGroup(options) -&gt; ArgumentGroup</p>
<ul>
<li>options (Object): hash of options see [[ArgumentGroup.new]]</li>
</ul>
</div>
<div class="body">
<p>Create new arguments groups</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">ActionContainer.prototype.addArgumentGroup = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">options</span>) </span>{
  <span class="hljs-keyword">var</span> group = <span class="hljs-keyword">new</span> ArgumentGroup(<span class="hljs-keyword">this</span>, options);
  <span class="hljs-keyword">this</span>._actionGroups.push(group);
  <span class="hljs-keyword">return</span> group;
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29"></a>
</div>
<div class="dox">
<div class="summary">
<p>ActionContainer#addMutuallyExclusiveGroup(options) -&gt; ArgumentGroup</p>
<ul>
<li>options (Object): {required: false}</li>
</ul>
</div>
<div class="body">
<p>Create new mutual exclusive groups</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">ActionContainer.prototype.addMutuallyExclusiveGroup = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">options</span>) </span>{
  <span class="hljs-keyword">var</span> group = <span class="hljs-keyword">new</span> MutuallyExclusiveGroup(<span class="hljs-keyword">this</span>, options);
  <span class="hljs-keyword">this</span>._mutuallyExclusiveGroups.push(group);
  <span class="hljs-keyword">return</span> group;
};

ActionContainer.prototype._addAction = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">action</span>) </span>{
  <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30"></a>
</div>
<p>resolve any conflicts</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>._checkConflict(action);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31"></a>
</div>
<p>add to actions list</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>._actions.push(action);
  action.container = <span class="hljs-keyword">this</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32"></a>
</div>
<p>index the action by any option strings it has</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  action.optionStrings.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">optionString</span>) </span>{
    self._optionStringActions[optionString] = action;
  });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33"></a>
</div>
<p>set the flag if any option strings look like negative numbers</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  action.optionStrings.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">optionString</span>) </span>{
    <span class="hljs-keyword">if</span> (optionString.match(self._regexpNegativeNumber)) {
      <span class="hljs-keyword">if</span> (!self._hasNegativeNumberOptionals.some(<span class="hljs-built_in">Boolean</span>)) {
        self._hasNegativeNumberOptionals.push(<span class="hljs-literal">true</span>);
      }
    }
  });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34"></a>
</div>
<p>return the created action</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">return</span> action;
};

ActionContainer.prototype._removeAction = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">action</span>) </span>{
  <span class="hljs-keyword">var</span> actionIndex = <span class="hljs-keyword">this</span>._actions.indexOf(action);
  <span class="hljs-keyword">if</span> (actionIndex &gt;= <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">this</span>._actions.splice(actionIndex, <span class="hljs-number">1</span>);
  }
};

ActionContainer.prototype._addContainerActions = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">container</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35"></a>
</div>
<p>collect groups by titles</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> titleGroupMap = {};
  <span class="hljs-keyword">this</span>._actionGroups.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">group</span>) </span>{
    <span class="hljs-keyword">if</span> (titleGroupMap[group.title]) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(format(<span class="hljs-string">'Cannot merge actions - two groups are named "%s".'</span>, group.title));
    }
    titleGroupMap[group.title] = group;
  });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36"></a>
</div>
<p>map each action to its group</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> groupMap = {};
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">actionHash</span>(<span class="hljs-params">action</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37"></a>
</div>
<p>unique (hopefully?) string suitable as dictionary key</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">return</span> action.getName();
  }
  container._actionGroups.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">group</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38"></a>
</div>
<p>if a group with the title exists, use that, otherwise
create a new group matching the container's group</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (!titleGroupMap[group.title]) {
      titleGroupMap[group.title] = <span class="hljs-keyword">this</span>.addArgumentGroup({
        <span class="hljs-attr">title</span>: group.title,
        <span class="hljs-attr">description</span>: group.description
      });
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-39" id="section-39"></a>
</div>
<p>map the actions to their new group</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    group._groupActions.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">action</span>) </span>{
      groupMap[actionHash(action)] = titleGroupMap[group.title];
    });
  }, <span class="hljs-keyword">this</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-40" id="section-40"></a>
</div>
<p>add container's mutually exclusive groups
NOTE: if add_mutually_exclusive_group ever gains title= and
description= then this code will need to be expanded as above</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> mutexGroup;
  container._mutuallyExclusiveGroups.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">group</span>) </span>{
    mutexGroup = <span class="hljs-keyword">this</span>.addMutuallyExclusiveGroup({
      <span class="hljs-attr">required</span>: group.required
    });
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-41" id="section-41"></a>
</div>
<p>map the actions to their new mutex group</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    group._groupActions.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">action</span>) </span>{
      groupMap[actionHash(action)] = mutexGroup;
    });
  }, <span class="hljs-keyword">this</span>);  <span class="hljs-comment">// forEach takes a 'this' argument</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-42" id="section-42"></a>
</div>
<p>add all actions to this container or their group</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  container._actions.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">action</span>) </span>{
    <span class="hljs-keyword">var</span> key = actionHash(action);
    <span class="hljs-keyword">if</span> (groupMap[key]) {
      groupMap[key]._addAction(action);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>._addAction(action);
    }
  });
};

ActionContainer.prototype._getPositional = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">dest, options</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(dest)) {
    dest = dest[<span class="hljs-number">0</span>];
  }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43"></a>
</div>
<p>make sure required is not specified</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (options.required) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'"required" is an invalid argument for positionals.'</span>);
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44"></a>
</div>
<p>mark positional arguments as required if at least one is
always required</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (options.nargs !== c.OPTIONAL &amp;&amp; options.nargs !== c.ZERO_OR_MORE) {
    options.required = <span class="hljs-literal">true</span>;
  }
  <span class="hljs-keyword">if</span> (options.nargs === c.ZERO_OR_MORE &amp;&amp; <span class="hljs-keyword">typeof</span> options.defaultValue === <span class="hljs-string">'undefined'</span>) {
    options.required = <span class="hljs-literal">true</span>;
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45"></a>
</div>
<p>return the keyword arguments with no option strings</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  options.dest = dest;
  options.optionStrings = [];
  <span class="hljs-keyword">return</span> options;
};

ActionContainer.prototype._getOptional = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">args, options</span>) </span>{
  <span class="hljs-keyword">var</span> prefixChars = <span class="hljs-keyword">this</span>.prefixChars;
  <span class="hljs-keyword">var</span> optionStrings = [];
  <span class="hljs-keyword">var</span> optionStringsLong = [];

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46"></a>
</div>
<p>determine short and long option strings</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  args.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">optionString</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47"></a>
</div>
<p>error on strings that don't start with an appropriate prefix</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (prefixChars.indexOf(optionString[<span class="hljs-number">0</span>]) &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(format(<span class="hljs-string">'Invalid option string "%s": must start with a "%s".'</span>,
        optionString,
        prefixChars
      ));
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-48" id="section-48"></a>
</div>
<p>strings starting with two prefix characters are long options</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    optionStrings.push(optionString);
    <span class="hljs-keyword">if</span> (optionString.length &gt; <span class="hljs-number">1</span> &amp;&amp; prefixChars.indexOf(optionString[<span class="hljs-number">1</span>]) &gt;= <span class="hljs-number">0</span>) {
      optionStringsLong.push(optionString);
    }
  });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49"></a>
</div>
<p>infer dest, '--foo-bar' -&gt; 'foo_bar' and '-x' -&gt; 'x'</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> dest = options.dest || <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">delete</span> options.dest;

  <span class="hljs-keyword">if</span> (!dest) {
    <span class="hljs-keyword">var</span> optionStringDest = optionStringsLong.length ? optionStringsLong[<span class="hljs-number">0</span>] : optionStrings[<span class="hljs-number">0</span>];
    dest = $$.trimChars(optionStringDest, <span class="hljs-keyword">this</span>.prefixChars);

    <span class="hljs-keyword">if</span> (dest.length === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
        format(<span class="hljs-string">'dest= is required for options like "%s"'</span>, optionStrings.join(<span class="hljs-string">', '</span>))
      );
    }
    dest = dest.replace(<span class="hljs-regexp">/-/g</span>, <span class="hljs-string">'_'</span>);
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50"></a>
</div>
<p>return the updated keyword arguments</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  options.dest = dest;
  options.optionStrings = optionStrings;

  <span class="hljs-keyword">return</span> options;
};

ActionContainer.prototype._popActionClass = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">options, defaultValue</span>) </span>{
  defaultValue = defaultValue || <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">var</span> action = (options.action || defaultValue);
  <span class="hljs-keyword">delete</span> options.action;

  <span class="hljs-keyword">var</span> actionClass = <span class="hljs-keyword">this</span>._registryGet(<span class="hljs-string">'action'</span>, action, action);
  <span class="hljs-keyword">return</span> actionClass;
};

ActionContainer.prototype._getHandler = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> handlerString = <span class="hljs-keyword">this</span>.conflictHandler;
  <span class="hljs-keyword">var</span> handlerFuncName = <span class="hljs-string">'_handleConflict'</span> + $$.capitalize(handlerString);
  <span class="hljs-keyword">var</span> func = <span class="hljs-keyword">this</span>[handlerFuncName];
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> func === <span class="hljs-string">'undefined'</span>) {
    <span class="hljs-keyword">var</span> msg = <span class="hljs-string">'invalid conflict resolution value: '</span> + handlerString;
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(msg);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> func;
  }
};

ActionContainer.prototype._checkConflict = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">action</span>) </span>{
  <span class="hljs-keyword">var</span> optionStringActions = <span class="hljs-keyword">this</span>._optionStringActions;
  <span class="hljs-keyword">var</span> conflictOptionals = [];

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51"></a>
</div>
<p>find all options that conflict with this option
collect pairs, the string, and an existing action that it conflicts with</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  action.optionStrings.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">optionString</span>) </span>{
    <span class="hljs-keyword">var</span> conflOptional = optionStringActions[optionString];
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> conflOptional !== <span class="hljs-string">'undefined'</span>) {
      conflictOptionals.push([ optionString, conflOptional ]);
    }
  });

  <span class="hljs-keyword">if</span> (conflictOptionals.length &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">var</span> conflictHandler = <span class="hljs-keyword">this</span>._getHandler();
    conflictHandler.call(<span class="hljs-keyword">this</span>, action, conflictOptionals);
  }
};

ActionContainer.prototype._handleConflictError = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">action, conflOptionals</span>) </span>{
  <span class="hljs-keyword">var</span> conflicts = conflOptionals.map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">pair</span>) </span>{ <span class="hljs-keyword">return</span> pair[<span class="hljs-number">0</span>]; });
  conflicts = conflicts.join(<span class="hljs-string">', '</span>);
  <span class="hljs-keyword">throw</span> argumentErrorHelper(
    action,
    format(<span class="hljs-string">'Conflicting option string(s): %s'</span>, conflicts)
  );
};

ActionContainer.prototype._handleConflictResolve = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">action, conflOptionals</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52"></a>
</div>
<p>remove all conflicting options</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
  conflOptionals.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">pair</span>) </span>{
    <span class="hljs-keyword">var</span> optionString = pair[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> conflictingAction = pair[<span class="hljs-number">1</span>];
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-53" id="section-53"></a>
</div>
<p>remove the conflicting option string</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> i = conflictingAction.optionStrings.indexOf(optionString);
    <span class="hljs-keyword">if</span> (i &gt;= <span class="hljs-number">0</span>) {
      conflictingAction.optionStrings.splice(i, <span class="hljs-number">1</span>);
    }
    <span class="hljs-keyword">delete</span> self._optionStringActions[optionString];
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-54" id="section-54"></a>
</div>
<p>if the option now has no option string, remove it from the
container holding it</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (conflictingAction.optionStrings.length === <span class="hljs-number">0</span>) {
      conflictingAction.container._removeAction(conflictingAction);
    }
  });
};

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
